<div class="generation-container">
  <div class="generation-section">
    <h2 id="generation-title">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
        <path d="M12 2L2 7L12 12L22 7L12 2Z" stroke="#667eea" stroke-width="2" stroke-linecap="round"
          stroke-linejoin="round" />
        <path d="M2 17L12 22L22 17" stroke="#667eea" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
        <path d="M2 12L12 17L22 12" stroke="#667eea" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
      </svg>
      Generación Automática de Materiales Pedagógicos
    </h2>
    <p class="description" id="generation-description">Crea materiales educativos personalizados seleccionando los
      parámetros a continuación.</p>
    <form [formGroup]="generationForm" (ngSubmit)="generateMaterial()" role="form" aria-labelledby="generation-title">
      <div class="form-group">
        <label for="grade">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 14L16 10H13V4H11V10H8L12 14Z" stroke="currentColor" stroke-width="2" stroke-linecap="round"
              stroke-linejoin="round" />
            <path
              d="M5 21H19C20.1046 21 21 20.1046 21 19V5C21 3.89543 20.1046 3 19 3H5C3.89543 3 3 3.89543 3 5V19C3 20.1046 3.89543 21 5 21Z"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
          </svg>
          Grado:
        </label>
        <select id="grade" formControlName="grade">
          <option value="">Seleccionar grado</option>
          <option value="1">1° Grado</option>
          <option value="2">2° Grado</option>
          <option value="3">3° Grado</option>
          <option value="4">4° Grado</option>
          <option value="5">5° Grado</option>
          <option value="6">6° Grado</option>
        </select>
      </div>
      <div class="form-group">
        <label for="subject">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M4 19.5C4 18.837 4.26339 18.2011 4.73223 17.7322C5.20107 17.2634 5.83696 17 6.5 17H20"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
            <path
              d="M6.5 2H20V22H6.5C5.83696 22 5.20107 21.7366 4.73223 21.2678C4.26339 20.7989 4 20.163 4 19.5V4.5C4 3.83696 4.26339 3.20107 4.73223 2.73223C5.20107 2.26339 5.83696 2 6.5 2Z"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
          </svg>
          Área:
        </label>
        <select id="subject" formControlName="subject">
          <option value="">Seleccionar área</option>
          <option value="Matemáticas">Matemáticas</option>
          <option value="Lenguaje">Lenguaje</option>
          <option value="Ciencias">Ciencias</option>
          <option value="Historia">Historia</option>
          <option value="Geografía">Geografía</option>
        </select>
      </div>
      <div class="form-group">
        <label for="materialType">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path
              d="M14 2H6C5.46957 2 4.96086 2.21071 4.58579 2.58579C4.21071 2.96086 4 3.46957 4 4V20C4 20.5304 4.21071 21.0391 4.58579 21.4142C4.96086 21.7893 5.46957 22 6 22H18C18.5304 22 19.0391 21.7893 19.4142 21.4142C19.7893 21.0391 20 20.5304 20 20V8L14 2Z"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
            <polyline points="14,2 14,8 20,8" stroke="currentColor" stroke-width="2" stroke-linecap="round"
              stroke-linejoin="round" />
            <line x1="16" y1="13" x2="8" y2="13" stroke="currentColor" stroke-width="2" stroke-linecap="round"
              stroke-linejoin="round" />
            <line x1="16" y1="17" x2="8" y2="17" stroke="currentColor" stroke-width="2" stroke-linecap="round"
              stroke-linejoin="round" />
            <polyline points="10,9 9,9 8,9" stroke="currentColor" stroke-width="2" stroke-linecap="round"
              stroke-linejoin="round" />
          </svg>
          Tipo de Material:
        </label>
        <select id="materialType" formControlName="materialType">
          <option value="">Seleccionar tipo</option>
          <option value="Sesión de Aprendizaje">Sesión de Aprendizaje</option>
          <option value="Ficha Práctica">Ficha Práctica</option>
          <option value="Rúbrica">Rúbrica</option>
          <option value="Unidad de Aprendizaje">Unidad de Aprendizaje</option>
        </select>
      </div>
      <div class="form-group">
        <label for="topic">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path
              d="M9 21V19C9 17.9391 9.42143 16.9217 10.1716 16.1716C10.9217 15.4214 11.9391 15 13 15H19C20.0609 15 21.0783 15.4214 21.8284 16.1716C22.5786 16.9217 23 17.9391 23 19V21"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
            <path
              d="M16 7C16 9.20914 14.2091 11 12 11C9.79086 11 8 9.20914 8 7C8 4.79086 9.79086 3 12 3C14.2091 3 16 4.79086 16 7Z"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
            <path
              d="M15 7C15 8.10457 14.1046 9 13 9C11.8954 9 11 8.10457 11 7C11 5.89543 11.8954 5 13 5C14.1046 5 15 5.89543 15 7Z"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
          </svg>
          Tema:
        </label>
        <input type="text" id="topic" formControlName="topic" placeholder="Ej: Números naturales">
      </div>
      <button type="submit" class="primary-btn" [disabled]="generationForm.invalid || isLoading"
        aria-describedby="generation-description">
        <svg *ngIf="!isLoading" width="20" height="20" viewBox="0 0 24 24" fill="none"
          xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
          <path d="M13 2L3 14H12L11 22L21 10H12L13 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round"
            stroke-linejoin="round" />
        </svg>
        <div *ngIf="isLoading" class="spinner" aria-hidden="true"></div>
        {{ isLoading ? 'Generando...' : 'Generar Material' }}
      </button>
    </form>
    <div *ngIf="generatedMaterial" class="generated-material" role="region" aria-labelledby="generated-title">
      <div class="material-header">
        <h3 id="generated-title">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"
            aria-hidden="true">
            <path d="M9 12L11 14L15 10" stroke="#10B981" stroke-width="2" stroke-linecap="round"
              stroke-linejoin="round" />
            <path
              d="M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z"
              stroke="#10B981" stroke-width="2" />
          </svg>
          ¡Material Generado Exitosamente!
        </h3>
        <span class="material-type-badge">{{ generatedMaterial?.type }}</span>
      </div>

      <div class="material-info">
        <div class="info-item">
          <span class="info-label">Grado:</span>
          <span class="info-value">{{ generatedMaterial?.grade }}°</span>
        </div>
        <div class="info-item">
          <span class="info-label">Área:</span>
          <span class="info-value">{{ generatedMaterial?.subject }}</span>
        </div>
        <div class="info-item">
          <span class="info-label">Tema:</span>
          <span class="info-value">{{ generatedMaterial?.topic }}</span>
        </div>
      </div>

      <div class="material-content">
        <pre>{{ generatedMaterial?.content }}</pre>
      </div>

      <div class="export-buttons">
        <button class="export-btn pdf-btn" (click)="exportMaterial('pdf')" [disabled]="!generatedMaterial">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path
              d="M14 2H6C5.46957 2 4.96086 2.21071 4.58579 2.58579C4.21071 2.96086 4 3.46957 4 4V20C4 20.5304 4.21071 21.0391 4.58579 21.4142C4.96086 21.7893 5.46957 22 6 22H18C18.5304 22 19.0391 21.7893 19.4142 21.4142C19.7893 21.0391 20 20.5304 20 20V8L14 2Z"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
            <polyline points="14,2 14,8 20,8" stroke="currentColor" stroke-width="2" stroke-linecap="round"
              stroke-linejoin="round" />
          </svg>
          Descargar PDF
        </button>
        <button class="export-btn docx-btn" (click)="exportMaterial('docx')" [disabled]="!generatedMaterial">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path
              d="M14 2H6C5.46957 2 4.96086 2.21071 4.58579 2.58579C4.21071 2.96086 4 3.46957 4 4V20C4 20.5304 4.21071 21.0391 4.58579 21.4142C4.96086 21.7893 5.46957 22 6 22H18C18.5304 22 19.0391 21.7893 19.4142 21.4142C19.7893 21.0391 20 20.5304 20 20V8L14 2Z"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
            <polyline points="14,2 14,8 20,8" stroke="currentColor" stroke-width="2" stroke-linecap="round"
              stroke-linejoin="round" />
            <line x1="16" y1="13" x2="8" y2="13" stroke="currentColor" stroke-width="2" stroke-linecap="round"
              stroke-linejoin="round" />
            <line x1="16" y1="17" x2="8" y2="17" stroke="currentColor" stroke-width="2" stroke-linecap="round"
              stroke-linejoin="round" />
          </svg>
          Descargar DOCX
        </button>
      </div>
    </div>
  </div>
</div>