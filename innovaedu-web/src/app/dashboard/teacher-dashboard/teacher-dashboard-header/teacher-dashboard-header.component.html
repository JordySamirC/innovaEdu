<header class="main-header">
  <div class="search-bar">
    <input type="text" placeholder="Buscar materiales, tutoriales..." class="search-input">
  </div>
  <div class="user-section">
    <div class="user-dropdown" [class.open]="dropdownOpen">
      <div class="user-info" (click)="toggleDropdown()">
        <svg class="user-icon" viewBox="0 0 24 24" fill="currentColor">
          <circle cx="12" cy="8" r="4" />
          <path d="M20 20c0-4.4-3.6-8-8-8s-8 3.6-8 8" />
        </svg>
        <span class="user-email">{{ userName }}</span>
        <svg class="dropdown-arrow" viewBox="0 0 24 24" fill="currentColor">
          <path d="M7 10l5 5 5-5z" />
        </svg>
      </div>
      <div class="dropdown-menu" [class.open]="dropdownOpen" *ngIf="dropdownOpen">
        <div class="dropdown-item user-email-display">
          <svg viewBox="0 0 24 24" fill="currentColor">
            <path
              d="M20,8L12,13L4,8V6L12,11L20,6M20,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V6C22,4.89 21.1,4 20,4Z" />
          </svg>
          {{ userEmail }}
        </div>
        <button class="dropdown-item" (click)="openEditModal()">
          <svg viewBox="0 0 24 24" fill="currentColor">
            <circle cx="12" cy="8" r="4" />
            <path d="M20 20c0-4.4-3.6-8-8-8s-8 3.6-8 8" />
          </svg>
          Cuenta
        </button>
        <button class="dropdown-item" (click)="logout()">
          <svg viewBox="0 0 24 24" fill="currentColor">
            <path
              d="M16 17v-3H9v-4h7V7l5 5-5 5M14 2a2 2 0 0 1 2 2v2h-2V4H5v16h9v-2h2v2a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9z" />
          </svg>
          Cerrar Sesión
        </button>
      </div>
    </div>
  </div>
</header>

<!-- Edit Account Modal -->
<div class="modal-overlay" *ngIf="isEditModalOpen" (click)="closeEditModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3>Editar Cuenta</h3>
      <button class="close-btn" (click)="closeEditModal()">
        <svg viewBox="0 0 24 24" fill="currentColor">
          <path
            d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z" />
        </svg>
      </button>
    </div>
    <div class="modal-layout">
      <aside class="modal-sidebar">
        <button [class.active]="activeTab === 'account'" (click)="setActiveTab('account')">
          <svg viewBox="0 0 24 24" fill="currentColor">
            <circle cx="12" cy="8" r="4" />
            <path d="M20 20c0-4.4-3.6-8-8-8s-8 3.6-8 8" />
          </svg>
          Editar Cuenta
        </button>
        <button [class.active]="activeTab === 'password'" (click)="setActiveTab('password')">
          <svg viewBox="0 0 24 24" fill="currentColor">
            <path d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zM9 6c0-1.66 1.34-3 3-3s3 1.34 3 3v2H9V6zm3 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2z" />
          </svg>
          Cambiar Contraseña
        </button>
      </aside>
      <main class="modal-main">
        <form [formGroup]="editForm" (ngSubmit)="saveChanges()" class="form-content">
          <div *ngIf="activeTab === 'account'">
            <h4>Editar Cuenta</h4>
            <div class="form-group">
              <label for="nombres">
                <svg viewBox="0 0 24 24" fill="currentColor">
                  <circle cx="12" cy="8" r="4" />
                  <path d="M20 20c0-4.4-3.6-8-8-8s-8 3.6-8 8" />
                </svg>
                Nombres:
              </label>
              <input type="text" id="nombres" formControlName="nombres" placeholder="Ej: Juan Carlos">
              <div class="error-message" *ngIf="editForm.get('nombres')?.invalid && editForm.get('nombres')?.touched">Campo requerido</div>
            </div>
            <div class="form-group">
              <label for="apellidos">
                <svg viewBox="0 0 24 24" fill="currentColor">
                  <circle cx="12" cy="8" r="4" />
                  <path d="M20 20c0-4.4-3.6-8-8-8s-8 3.6-8 8" />
                </svg>
                Apellidos:
              </label>
              <input type="text" id="apellidos" formControlName="apellidos" placeholder="Ej: Pérez López">
              <div class="error-message" *ngIf="editForm.get('apellidos')?.invalid && editForm.get('apellidos')?.touched">Campo requerido</div>
            </div>
            <div class="form-group">
              <label for="telefono">
                <svg viewBox="0 0 24 24" fill="currentColor">
                  <path d="M6.62 10.79c1.44 2.83 3.76 5.15 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z" />
                </svg>
                Teléfono:
              </label>
              <input type="tel" id="telefono" formControlName="telefono" placeholder="+51 999 999 999">
              <div class="error-message" *ngIf="editForm.get('telefono')?.invalid && editForm.get('telefono')?.touched">Formato inválido (ej: +51 999999999)</div>
            </div>
            <div class="form-group">
              <label for="email">
                <svg viewBox="0 0 24 24" fill="currentColor">
                  <path d="M20,8L12,13L4,8V6L12,11L20,6M20,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V6C22,4.89 21.1,4 20,4Z" />
                </svg>
                Correo Electrónico:
              </label>
              <input type="email" id="email" formControlName="email" placeholder="tu.email@institucion.edu.pe">
              <div class="error-message" *ngIf="editForm.get('email')?.invalid && editForm.get('email')?.touched">Correo inválido</div>
            </div>
            <div class="form-group">
              <label for="nivelEducativo">
                <svg viewBox="0 0 24 24" fill="currentColor">
                  <path d="M12 2L13.09 8.26L19 9L13.09 9.74L12 16L10.91 9.74L5 9L10.91 8.26L12 2Z" />
                </svg>
                Nivel Educativo:
              </label>
              <select id="nivelEducativo" formControlName="nivelEducativo">
                <option value="">Seleccionar</option>
                <option value="Inicial">Inicial</option>
                <option value="Primaria">Primaria</option>
                <option value="Secundaria">Secundaria</option>
              </select>
              <div class="error-message" *ngIf="editForm.get('nivelEducativo')?.invalid && editForm.get('nivelEducativo')?.touched">Campo requerido</div>
            </div>
            <div class="form-group">
              <label for="asignatura">
                <svg viewBox="0 0 24 24" fill="currentColor">
                  <path d="M12 2L13.09 8.26L19 9L13.09 9.74L12 16L10.91 9.74L5 9L10.91 8.26L12 2Z" />
                </svg>
                Asignatura:
              </label>
              <select id="asignatura" formControlName="asignatura">
                <option value="">Seleccionar</option>
                <option value="Matemáticas">Matemáticas</option>
                <option value="Lenguaje">Lenguaje</option>
                <option value="Ciencias">Ciencias</option>
                <option value="Historia">Historia</option>
                <option value="Geografía">Geografía</option>
                <option value="Inglés">Inglés</option>
                <option value="Educación Física">Educación Física</option>
                <option value="Arte">Arte</option>
                <option value="Educación Religiosa">Educación Religiosa</option>
              </select>
              <div class="error-message" *ngIf="editForm.get('asignatura')?.invalid && editForm.get('asignatura')?.touched">Campo requerido</div>
            </div>
          </div>
          <div *ngIf="activeTab === 'password'">
            <h4>Cambiar Contraseña</h4>
            <div class="form-group">
              <label for="newPassword">
                <svg viewBox="0 0 24 24" fill="currentColor">
                  <path d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zM9 6c0-1.66 1.34-3 3-3s3 1.34 3 3v2H9V6zm3 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2z" />
                </svg>
                Nueva Contraseña:
              </label>
              <input type="password" id="newPassword" formControlName="newPassword" placeholder="Mínimo 8 caracteres">
              <div class="error-message" *ngIf="editForm.get('newPassword')?.value && editForm.get('newPassword')?.invalid && editForm.get('newPassword')?.touched">Contraseña demasiado corta (mínimo 8 caracteres)</div>
            </div>
          </div>
          <div class="modal-actions">
            <button type="button" class="cancel-btn" (click)="closeEditModal()">Cancelar</button>
            <button type="submit" class="save-btn" [disabled]="editForm.invalid">Guardar Cambios</button>
          </div>
        </form>
      </main>
    </div>
  </div>
</div>